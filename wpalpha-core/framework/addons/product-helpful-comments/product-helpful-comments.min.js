window.theme||(window.theme={}),function(a){var e={action:"alpha_get_comments",post_id:null,mode:"all",page:1,$tabs:null,$pagination:null,$panel:null,$activePanel:null,cache:{},init:function(){this.$tabs=a(".woocommerce-Reviews .nav-tabs"),this.$pagination=a(".woocommerce-Reviews .pagination"),this.post_id=this.$tabs.data("post_id"),a("body").on("click",".woocommerce-Reviews .nav-link",this.filterComments).on("click",".woocommerce-pagination .page-numbers",this.changePage).on("click",".review-vote .comment_help, .review-vote .comment_unhelp",this.onVoteComment)},filterComments:function(t){var n=a(this);if(!e.$tabs.hasClass("loading")){var i="SPAN"==this.tagName?n.data("href"):n.attr("href");e.$panel="#"==i?n.closest(".nav").siblings(".tab-content").children(".tab-pane").eq(n.parent().index()):a(("#"==i.substring(0,1)?"":"#")+i),e.$panel.length&&(t.preventDefault(),e.$activePanel=e.$panel.parent().children(".active"),!n.hasClass("active")&&i&&(e.$tabs.find(".active").removeClass("active"),n.addClass("active"),e.mode=n.data("mode"),e.page=1,e.getComments()))}},changePage:function(t){var n=a(this),i=n.attr("href");t.preventDefault(),n.hasClass("prev")?e.page=parseInt(n.siblings(".current").text())-1:n.hasClass("next")?e.page=parseInt(n.siblings(".current").text())+1:e.page=parseInt(n.text()),e.$panel=e.$activePanel=e.$tabs.siblings(".tab-content").children(".active"),e.getComments(i)},getComments:function(t=""){e.cache[e.mode]||(e.cache[e.mode]={});var n=e.cache[e.mode],i=e.page;if(n&&n[i]){var o=n[i];!o.html.trim()&&e.$panel.data("empty")?e.$panel.html(e.$panel.data("empty")):e.$panel.html(o.html),e.$pagination.html(o.pagination),e.changeTab()}else e.$tabs.addClass("loading"),e.$activePanel.addClass("loading"),e.$pagination&&theme.doLoading(e.$pagination,"small"),a.post(alpha_vars.ajax_url,{action:this.action,nonce:alpha_vars.nonce,post_id:this.post_id,mode:this.mode,page:this.page},(function({html:a,pagination:o}){n||(n={}),n[i]||(n[i]={}),n[i]={html:a,pagination:o},e.$pagination&&theme.endLoading(e.$pagination),e.$activePanel.removeClass("loading"),e.$tabs.removeClass("loading"),!a.trim()&&e.$panel.data("empty")?e.$panel.html(e.$panel.data("empty")):e.$panel.html(a),e.$pagination.html(o),e.changeTab(),t&&history.pushState({},"",t)}))},changeTab:function(){theme.loadTemplate(this.$panel),theme.slider(this.$panel.find(".slider-wrapper")),this.$activePanel.removeClass("in active"),this.$panel.addClass("active in"),theme.refreshLayouts()},onVoteComment:function(t){var n=a(this),i=n.data("comment_id"),o=n.hasClass("comment_help")?"fa-thumbs-up":"fa-thumbs-down";n.hasClass("already_comment")?n.parent().children(".already_vote").fadeIn().fadeOut(1e3):(n.addClass("already_comment").parent().find(".comment_unhelp").addClass("already_comment"),a("#alpha_review_vote-"+i+" ."+o).removeClass(o).addClass("fa-spinner fas"),a.post(alpha_vars.ajax_url,{action:"comment_vote",nonce:alpha_vars.nonce,comment_id:i,commentvote:n.hasClass("comment_help")?"plus":"minus"},(function(a){e.$activePanel=e.$tabs.siblings(".tab-content").children(".active"),"updated"===a?(e.$activePanel.find("#alpha_review_vote-"+i+" .fa-spinner").removeClass("fa-spinner fas").addClass(o),e.$activePanel.find("#comment"+(n.hasClass("comment_help")?"":"un")+"help-count-"+i).text(n.data("count")+1)):"voted"===a&&(e.$activePanel.find("#alpha_review_vote-"+i+" .fa-spinner").removeClass("fa-spinner fas").addClass(o),n.parent().children(".already_vote").fadeIn().fadeOut(1e3))})))}};theme.ProductHelpfulComments=e,theme.$window.on("alpha_complete",(function(){theme.ProductHelpfulComments.init()}))}(jQuery);